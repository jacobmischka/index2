<div class="{{ `directory ${hidden ? 'hidden' : ''}` }}">
	<button type="button" on:click="set({expanded: !expanded})">
		{{ expanded ? 'Close': 'Open' }}
	</button>
	<div class="details">
		<Node name="{{ name }}"
			size="{{ size }}"
			lastModified="{{ lastModified }}" />

		{{#if expanded}}
			<div class="children">
				{{#each sortedChildren as child}}
					{{#if child.type === 'directory'}}
						<:Self
							name="{{ child.name }}"
							size="{{ child.size }}"
							lastModified="{{ lastModified}}"
							children="{{ child.children }}"
							hidden="{{ child.hidden }}" />
					{{else}}
						<File
							name="{{ child.name }}"
							size="{{ child.size }}"
							lastModified="{{ lastModified}}"
							hidden="{{ child.hidden }}" />
					{{/if}}
				{{/each}}
			</div>
		{{/if}}
	</div>
</div>

<script>
import Node from './Node.html';
import File from './File.html';

import { sortNodes } from '../utils.js';

export default {
	data() {
		return {
			name: '',
			size: 0,
			lastModified: 'today',
			children: [],
			hidden: false,

			expanded: false
		};
	},

	computed: {
		sortedChildren(children) {
			return sortNodes(children);
		}
	},

	components: {
		Node,
		File
	}
};
</script>

<style>
	.directory {
		display: flex;
		flex-direction: row;
		align-items: flex-start;
	}

	.directory.hidden {
		display: none;
	}

	.details {
		flex-grow: 1;
	}

	.children {
		margin-left: 2em;
	}
</style>
